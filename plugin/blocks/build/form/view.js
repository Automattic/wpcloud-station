wpcloud.bindFormHandler=o=>{const t=o.querySelector('button[type="submit"]');o.addEventListener("submit",(async e=>{e.preventDefault(),t.setAttribute("disabled","disabled"),o.classList.add("is-loading"),o.classList.remove("is-error");const a=Object.fromEntries(new FormData(o).entries());a.action="wpcloud_form_submit";const r=window.location.search,d=new URLSearchParams(r).get("ref");d&&(a.redirect=d);try{const e=await fetch("http://localhost:8888/wp-admin/admin-ajax.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a).toString()});wpcloud.hooks.doAction("wpcloud_form_submit",o);const r=await e.json();wpcloud.hooks.doAction("wpcloud_form_response",r.data),e.ok&&r?.data?.redirect&&(window.location=r.data.redirect),t.removeAttribute("disabled"),o.classList.remove("is-loading"),e.ok||o.classList.add("is-error")}catch(o){console.error(o)}}))},document.querySelectorAll("form.wpcloud-block-form[data-ajax]").forEach(wpcloud.bindFormHandler);